# This testnet tests the unified blocksync functionality.
# It has validators that start at different heights to test:
# 1. Blocksync from genesis
# 2. Blocksync catching up to live consensus
# 3. Catchup after disconnection

initial_height = 1

# Small delays to produce blocks quickly but allow time for blocksync
prepare_proposal_delay = "50ms"
process_proposal_delay = "50ms"

# Use builtin protocol for faster testing
abci_protocol = "builtin"

[validators]
validator01 = 100
validator02 = 100
validator03 = 100
validator04 = 100

# validator01-04 are initial validators that produce blocks
[node.validator01]
snapshot_interval = 5

[node.validator02]
persistent_peers = ["validator01"]

[node.validator03]
persistent_peers = ["validator01", "validator02"]

[node.validator04]
persistent_peers = ["validator01", "validator02", "validator03"]

# full01 starts late and must blocksync to catch up
# This tests the unified blocksync from genesis
[node.full01]
mode = "full"
persistent_peers = ["validator01", "validator02", "validator03", "validator04"]
start_at = 20

# full02 starts even later and uses state sync first
# This tests blocksync after state sync
[node.full02]
mode = "full"
persistent_peers = ["validator01", "full01"]
start_at = 40
state_sync = true

# full03 starts early but gets killed and restarted
# This tests catchup after reconnection
[node.full03]
mode = "full"
persistent_peers = ["validator01", "validator02"]
start_at = 5
perturb = ["kill", "restart"]
